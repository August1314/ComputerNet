# IPv4地址详解

## IPv4地址分类

### A类地址
**网络ID位：** 8位 | **主机ID位：** 24位
- 这类网络ID被分配给拥有大量主机的网络
- 前缀长度只有8位，最高位是0
- 剩余的24位可用来标识16,777,214个主机ID
- 较短的前缀长度使可接受A类网络ID的网络数量限制为126个
- 地址范围：1.0.0.0 - 126.255.255.255

### B类地址
**网络ID位：** 16位 | **主机ID位：** 16位
- 前缀长度有16位，最高两位是10
- 剩余的16位可用来标识65,534个主机ID
- 较短的前缀长度使可接受B类网络ID的网络数量限制为16,384个
- 地址范围：128.0.0.0 - 191.255.255.255

### C类地址
**网络ID位：** 24位 | **主机ID位：** 8位
- 前缀长度有24位，最高三位是110
- 剩余的8位可用来标识254个主机ID
- 较短的前缀长度使可接受C类网络ID的网络数量限制为2,097,152个
- 地址范围：192.0.0.0 - 223.255.255.255

### D类地址
**用途：** 多播地址
- 最高四位是1110
- 用于多播通信，不分配给单个主机
- 地址范围：224.0.0.0 - 239.255.255.255

### E类地址
**用途：** 保留地址
- 最高四位是1111
- 保留用于实验和研究
- 地址范围：240.0.0.0 - 255.255.255.255


## 特殊IP地址

### 网络地址
- **定义：** 主机号全为0的IP表示某网络号的网络本身
- **示例：** 192.168.1.0 表示192.168.1.0/24这个网段

### 广播地址
- **定义：** 主机号全为1的IP表示本网广播地址
- **示例：** 192.168.1.255 表示192.168.1.0/24网段的广播地址

### 回环地址
- **定义：** 第一段十进制数值为127是保留地址，用于环路反馈等测试
- **示例：** 127.0.0.1 代表本机地址
- **范围：** 127.0.0.0 - 127.255.255.255

### 全0地址
- **定义：** 整个IP地址为0表示一个未知的网络
- **示例：** 0.0.0.0 通常用作默认路由

## 公有IP与私有IP地址

### 公有IP地址
- **用途：** 用于因特网，全球唯一
- **特点：** 可以直接访问互联网
- **分配：** 由IANA统一分配

### 私有IP地址
- **用途：** 专用于组织的专用网内部
- **特点：** 不能直接访问互联网，需要NAT转换
- **范围：**
  - **A类私有地址：** 10.0.0.0 - 10.255.255.255 (10.0.0.0/8)
  - **B类私有地址：** 172.16.0.0 - 172.31.255.255 (172.16.0.0/12)
  - **C类私有地址：** 192.168.0.0 - 192.168.255.255 (192.168.0.0/16)

## 网络掩码

### 作用
标识一个IP的网络号范围，用于区分网络部分和主机部分

### 结构
- 长度32位，由一串1和紧随的一串0组成
- 1对应于IP中的网络号（子网号）
- 0对应于IP地址中的主机号

### 默认子网掩码表格

| 地址类别 | 默认子网掩码 | 二进制表示 | CIDR表示 |
|----------|--------------|------------|----------|
| A类 | 255.0.0.0 | 11111111.00000000.00000000.00000000 | /8 |
| B类 | 255.255.0.0 | 11111111.11111111.00000000.00000000 | /16 |
| C类 | 255.255.255.0 | 11111111.11111111.11111111.00000000 | /24 |

## 子网掩码与子网划分

### 子网与主机个数计算公式

#### 子网数量计算
- **公式：** 子网数 = 2^n
- **n：** 从主机位借用的位数

#### 主机数量计算
- **公式：** 主机数 = 2^m - 2
- **m：** 剩余的主机位数
- **减2：** 减去网络地址和广播地址

#### 子网掩码计算
- **公式：** 新子网掩码 = 原网络位 + 借用的子网位
- **示例：** C类地址(/24)借用2位 → 新掩码/26


## IP地址表示方式

### 网络地址表示
- **192.168.1.0** - 不表示一个具体IP地址，而是表示一网段的网络地址

### 广播地址表示
- **192.168.1.255** - 表示一个广播地址

### CIDR表示法
- **192.168.1.1/24** - 用CIDR表示的IP，/后的数字表示掩码的高24位为1，其余为0

## 网段判断方法

### 判断主机是否在同一网段的步骤
1. 将IP地址与子网掩码进行逻辑与运算
2. 比较运算结果
3. 结果相同的就在同一网段内

### 示例
- **主机A：** 192.168.1.10/24
- **主机B：** 192.168.1.20/24
- **计算：** 192.168.1.10 & 255.255.255.0 = 192.168.1.0
- **计算：** 192.168.1.20 & 255.255.255.0 = 192.168.1.0
- **结果：** 两主机在同一网段

## 子网划分实例

### 题目
4间机房，每间25台机器，给定IP：192.168.10.0，要划分为4个子网，尽可能最小浪费IP地址，而且要满足现有IP地址需求。

## 子网划分题目解答

**题目：** 4间机房，每间25台机器，给定IP：192.168.10.0，要划分为4个子网，尽可能最小浪费IP地址。

### 解题过程

1. **分析需求：**
   - 需要4个子网
   - 每个子网需要25台主机
   - 使用IP段：192.168.10.0

2. **计算子网位数：**
   - 2^n ≥ 4，n = 2位

3. **计算主机位数：**
   - 每子网需要25台主机 + 网络地址 + 广播地址 = 27
   - 2^m ≥ 27，m = 5位

4. **确定子网掩码：**
   - 原始网络位：24位
   - 子网位：2位
   - 主机位：5位
   - 新网络位：24 + 2 = 26位
   - 子网掩码：255.255.255.192 (/26)

### 子网分配方案

| 子网 | 网络地址 | 可用主机范围 | 广播地址 | 可用主机数 |
|------|----------|--------------|----------|------------|
| 机房1 | 192.168.10.0/26 | 192.168.10.1 - 192.168.10.30 | 192.168.10.31 | 30台 |
| 机房2 | 192.168.10.32/26 | 192.168.10.33 - 192.168.10.62 | 192.168.10.63 | 30台 |
| 机房3 | 192.168.10.64/26 | 192.168.10.65 - 192.168.10.94 | 192.168.10.95 | 30台 |
| 机房4 | 192.168.10.96/26 | 192.168.10.97 - 192.168.10.126 | 192.168.10.127 | 30台 |

### 验证结果
- ✅ 4个子网：满足要求
- ✅ 每间机房25台机器：每个子网提供30个可用主机地址
- ✅ 最小浪费：每个子网只浪费5个IP地址
- ✅ 使用给定IP段：192.168.10.0

**答案：** 使用子网掩码255.255.255.192 (/26)进行子网划分，每个子网可容纳30台主机，满足25台机器的需求，总浪费20个IP地址。

